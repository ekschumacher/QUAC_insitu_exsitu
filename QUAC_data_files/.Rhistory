for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
#QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
# QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
# colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
# if(pop == 1){
##name rows for garden individuals
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
# }else{
##name rows with all population names
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
#  }
#   if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
#      QUAC_mean_lon <- matrix()
#      QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
#    for(pop2 in QUAC_wildpop_names){
#      QUAC_mean_lon[pop2] <- mean(QUAC_wild_lonlat_clean_df[,3])
#      QUAC_mean_lon <- matrix(QUAC_mean_lon)
#   }
#for(pop2 in QUAC_pop_names){
#    QUAC_mean_lat[pop2] <- mean(QUAC_wild_lonlat_clean_df[,4])
#     QUAC_mean_lat <- matrix(QUAC_mean_lat)
#  }
#  QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
#  QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
#  QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
#}
##write out csv
# write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
#QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
# colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
# if(pop == 1){
##name rows for garden individuals
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
# }else{
##name rows with all population names
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
#  }
#   if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
#      QUAC_mean_lon <- matrix()
#      QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
#    for(pop2 in QUAC_wildpop_names){
#      QUAC_mean_lon[pop2] <- mean(QUAC_wild_lonlat_clean_df[,3])
#      QUAC_mean_lon <- matrix(QUAC_mean_lon)
#   }
#for(pop2 in QUAC_pop_names){
#    QUAC_mean_lat[pop2] <- mean(QUAC_wild_lonlat_clean_df[,4])
#     QUAC_mean_lat <- matrix(QUAC_mean_lat)
#  }
#  QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
#  QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
#  QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
#}
##write out csv
# write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
QUAC_ind
QUAC_temp_gen
levels(QUAC_temp_gen@pop)
QUAC_nall
QUAC_ind
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
#QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
# colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
# if(pop == 1){
##name rows for garden individuals
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
# }else{
##name rows with all population names
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
#  }
#   if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
#      QUAC_mean_lon <- matrix()
#      QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
#    for(pop2 in QUAC_wildpop_names){
#      QUAC_mean_lon[pop2] <- mean(QUAC_wild_lonlat_clean_df[,3])
#      QUAC_mean_lon <- matrix(QUAC_mean_lon)
#   }
#for(pop2 in QUAC_pop_names){
#    QUAC_mean_lat[pop2] <- mean(QUAC_wild_lonlat_clean_df[,4])
#     QUAC_mean_lat <- matrix(QUAC_mean_lat)
#  }
#  QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
#  QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
#  QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
#}
##write out csv
# write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
QUAC_ind
QUAC_nall
QUAC_allrich_mean
QUAC_hexp_mean
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
# colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
# if(pop == 1){
##name rows for garden individuals
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
# }else{
##name rows with all population names
#   rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
#  }
#   if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
#      QUAC_mean_lon <- matrix()
#      QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
#    for(pop2 in QUAC_wildpop_names){
#      QUAC_mean_lon[pop2] <- mean(QUAC_wild_lonlat_clean_df[,3])
#      QUAC_mean_lon <- matrix(QUAC_mean_lon)
#   }
#for(pop2 in QUAC_pop_names){
#    QUAC_mean_lat[pop2] <- mean(QUAC_wild_lonlat_clean_df[,4])
#     QUAC_mean_lat <- matrix(QUAC_mean_lat)
#  }
#  QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
#  QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
#  QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
#}
##write out csv
# write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
QUAC_pop_df_list[[2]]
head(QUAC_pop_df_list[[2]])
head(QUAC_pop_df_list[[2]][,3])
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
QUAC_lonlat_df
QUAC_mean_lon
QUAC_wildpop_names
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "Mean_Lon", "Mean_Lat","MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##name pops
if(pop == 1){
levels(QUAC_temp_gen@pop) <- QUAC_gardenpop_names
}else{
levels(QUAC_temp_gen@pop) <- QUAC_wildpop_names
}
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_temp_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[pop]], "_gendiv_sumstat_df.csv"))
}
