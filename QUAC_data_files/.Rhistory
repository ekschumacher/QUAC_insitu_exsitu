library(adegenet)
library(poppr)
library(hierfstat)
library(PopGenReport)
library(pegas)
library(diveRsity)
#########################
#   Load Data Files     #
#########################
##set working directory to load in data files
setwd("../../QUAC_data_files")
##load in QUAC all pop genepop as a genind object
QUAC_clean_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_clean.gen", ncode = 3)
#load all pop data frames
QUAC_allpop_df <- read.csv("QUAC_data_frames/Garden_Wild/QUAC_clean_df.csv")
##load in lon/lat data frame for wild pops
QUAC_wild_lonlat_allpop_clean_df <- read.csv("QUAC_data_frames/Garden_Wild/QUAC_wild_lonlat_allpop_clean_df.csv")[,-1]
View(QUAC_wild_lonlat_allpop_clean_df)
View(QUAC_allpop_df)
#load all pop data frames
QUAC_allpop_df <- read.csv("QUAC_data_frames/Garden_Wild/QUAC_clean_df.csv")[,-1]
###########################################
#          Genetic Stats by Pop           #
###########################################
##Garden vs. wild diversity capture
#create lists for loop of the object and files used in analyses
QUAC_pop_type_gen <- list.files(path = "QUAC_adegenet_files/Garden_Wild", pattern = "allpop_clean.gen")
QUAC_clean_gen
View(QUAC_allpop_df)
levels(QUAC_clean_gen@pop)
##create a population name doc
QUAC_pop_names <- unique(QUAC_allpop_df$Pop)
levels(QUAC_clean_gen@pop) <- QUAC_pop_names
##name individuals
rownames(QUAC_clean_gen@tab) <- QUAC_allpop_df$Ind
#create list of population names
QUAC_wildpop_names <- QUAC_pop_names[18:22]
QUAC_gardenpop_names <- QUAC_pop_names[1:17]
##write loop to calculate all summary stats
for(pop_type in 1:length(pop_type_list)){
#subset data frame by the pop type - garden or wild
QUAC_df <- QUAC_allpop_df[QUAC_allpop_df$Garden_Wild == paste0(pop_type_list[[pop_type]]),]
#then subset genind by pop type - garden of wild
QUAC_gen <- QUAC_clean_gen[rownames(QUAC_clean_gen@tab) %in% QUAC_df$Ind,]
###start genetic analyses
#create genetic summary of the genind file
QUAC_sum <- summary(QUAC_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list <- allelic.richness(QUAC_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", pop_type_list[[pop_type]], "_gendiv_sumstat_df.csv"))
}
###########################################
#          Genetic Stats by Pop           #
###########################################
##create a list of pop types
pop_type_list <- c("Garden", "Wild")
#create list of population names
QUAC_wildpop_names <- QUAC_pop_names[18:22]
QUAC_gardenpop_names <- QUAC_pop_names[1:17]
##create data frame list
QUAC_pop_df_list <- list()
##write loop to calculate all summary stats
for(pop_type in 1:length(pop_type_list)){
#subset data frame by the pop type - garden or wild
QUAC_df <- QUAC_allpop_df[QUAC_allpop_df$Garden_Wild == paste0(pop_type_list[[pop_type]]),]
#then subset genind by pop type - garden of wild
QUAC_gen <- QUAC_clean_gen[rownames(QUAC_clean_gen@tab) %in% QUAC_df$Ind,]
###start genetic analyses
#create genetic summary of the genind file
QUAC_sum <- summary(QUAC_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list <- allelic.richness(QUAC_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", pop_type_list[[pop_type]], "_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop_type in 1:length(pop_type_list)){
#subset data frame by the pop type - garden or wild
QUAC_df <- QUAC_allpop_df[QUAC_allpop_df$Garden_Wild == paste0(pop_type_list[[pop_type]]),]
#then subset genind by pop type - garden of wild
QUAC_gen <- QUAC_clean_gen[rownames(QUAC_clean_gen@tab) %in% QUAC_df$Ind,]
###start genetic analyses
#create genetic summary of the genind file
QUAC_sum <- summary(QUAC_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list <- allelic.richness(QUAC_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop_type == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop_type]][QUAC_pop_df_list[[pop_type]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", pop_type_list[[pop_type]], "_gendiv_sumstat_df.csv"))
}
View(QUAC_wild_lonlat_allpop_clean_df)
#subset data frame by the pop type - garden or wild
QUAC_df <- QUAC_allpop_df[QUAC_allpop_df$Garden_Wild == 'Wild',]
View(QUAC_sum)
View(QUAC_wild_lonlat_allpop_clean_df)
head(cbind(QUAC_df[,c(1:2), QUAC_wild_lonlat_allpop_clean_df[,c(3:4)], QUAC_df[,c(3:33)]]))
head(cbind(QUAC_df[,c(1:2)], QUAC_wild_lonlat_allpop_clean_df[,c(3:4)], QUAC_df[,c(3:33)]]))
head(cbind(QUAC_df[,c(1:2)], QUAC_wild_lonlat_allpop_clean_df[,c(3:4)], QUAC_df[,c(3:33)]))
##write loop to calculate all summary stats
for(pop_type in 1:length(pop_type_list)){
#subset data frame by the pop type - garden or wild
QUAC_df <- QUAC_allpop_df[QUAC_allpop_df$Garden_Wild == paste0(pop_type_list[[pop_type]]),]
#then subset genind by pop type - garden of wild
QUAC_gen <- QUAC_clean_gen[rownames(QUAC_clean_gen@tab) %in% QUAC_df$Ind,]
###start genetic analyses
#create genetic summary of the genind file
QUAC_sum <- summary(QUAC_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(levels(QUAC_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(levels(QUAC_gen@pop)), 2:3]
##save allelic richness for comparison
QUAC_allrich_list <- allelic.richness(QUAC_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##create extra columns for mean lon/lat
if(pop_type == 2){
##add coordinates to the data frame
QUAC_wild_df <- cbind(QUAC_df[,c(1:2)], QUAC_wild_lonlat_allpop_clean_df[,c(3:4)], QUAC_df[,c(3:33)])
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean longitude and latitude for each population
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_wild_df[QUAC_wild_df$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_wildpop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_wild_df[QUAC_wild_df$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Mean_Lon", "Mean_Lat", "N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_wildpop_names
}else{
##name columns
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("N", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_gardenpop_names
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", pop_type_list[[pop_type]], "_gendiv_sumstat_df.csv"))
}
length(pop_type_list)
QUAC_gen
