library(adegenet)
library(diveRsity)
library(poppr)
library(hierfstat)
#####################################
############ Directories ############
#####################################
QUAC_data_files <- "C:\\Users\\eschumacher\\Documents\\GitHub\\QUAC_insitu_exsitu\\QUAC_data_files"
QUAC_analysis_results <- "C:\\Users\\eschumacher\\Documents\\GitHub\\QUAC_insitu_exsitu\\QUAC_analyses\\Results"
################################
########## Load files ##########
################################
setwd(QUAC_data_files)
##load in genind for QUAC
QUAC_garden_wild_gen <- read.genepop(paste0(QUAC_data_files, "\\QUAC_genind\\QUAC_garden_wild_clean.gen"), ncode = 3)
##load in data frame
QUAC_garden_wild_df <- read.csv(paste0(QUAC_data_files, "\\QUAC_data_frames\\QUAC_garden_wild_clean_df.csv"))
##rename individuals in the genind file
rownames(QUAC_garden_wild_gen@tab) <- QUAC_garden_wild_df$Ind
##rename population names
QUAC_popnames <- unique(QUAC_garden_wild_df$Pop)
levels(QUAC_garden_wild_gen@pop) <- QUAC_popnames
############################################################
############ Comparing wild and garden populations #########
############################################################
##calculate genetic diversity statistics
QUAC_wild_hexp <- summary(seppop(QUAC_garden_wild_gen)$Wild)[7]
QUAC_garden_hexp <- summary(seppop(QUAC_garden_wild_gen)$Garden)[7]
##calculate allelic richness
QUAC_wild_allrich <- allelic.richness(seppop(QUAC_garden_wild_gen)$Wild)$Ar
QUAC_garden_allrich <- allelic.richness(seppop(QUAC_garden_wild_gen)$Garden)$Ar
barplot(QUAC_garden_allrich, QUAC_wild_allrich)
QUAC_garden_allrich
##create gendiv data frame
QUAC_gendiv_df <- matrix(nrow = 30, ncol = 3)
QUAC_gendiv_df[1:15,1] <- c("Garden")
QUAC_gendiv_df[16:30,1] <- c("Wild")
##load in heterozygosity
QUAC_gendiv_df[1:15,2] <- QUAC_garden_hexp$Hexp
QUAC_gendiv_df[16:30,2] <- QUAC_wild_hexp$Hexp
##load in allelic richness
QUAC_gendiv_df[1:15,3] <- QUAC_wild_allrich[,1]
QUAC_gendiv_df[16:30,3] <- QUAC_garden_allrich[,1]
#####test for normality and homogeneity of variance --hexp
##test homogeneity of variances
var.test(as.numeric(QUAC_gendiv_df[,2])~as.factor(QUAC_gendiv_df[,1]))
##normality test
shapiro.test(as.numeric(QUAC_gendiv_df[,2]))
##run t-test
hexp_krusk <- kruskal.test(as.numeric(QUAC_gendiv_df[,2])~as.factor(QUAC_gendiv_df[,1]))
#####t-test for allelic richness
##test for homogeneity of variance
var.test(as.numeric(QUAC_gendiv_df[,3])~as.factor(QUAC_gendiv_df[,1]))
##test for normal data
shapiro.test(as.numeric(QUAC_gendiv_df[,3]))
##do kruskal-wallis
##run t-test
allrich_krusk <- kruskal.test(as.numeric(QUAC_gendiv_df[,3])~as.factor(QUAC_gendiv_df[,1]))
##results data frame
QUAC_garden_wild_results <- matrix(nrow = 2, ncol = 3)
##name columns and rows
rownames(QUAC_garden_wild_results) <- c("Expected Heterozygosity", "Allelic Richness")
colnames(QUAC_garden_wild_results) <- c("Garden Mean", "Wild Mean", "P-Value")
##add values
QUAC_garden_wild_results[1,3] <- hexp_krusk[3]$p.value
QUAC_garden_wild_results[2,3] <- allrich_krusk[3]$p.value
QUAC_garden_wild_results[1,1] <- mean(QUAC_garden_hexp$Hexp) ; QUAC_garden_wild_results[1,2] <- mean(QUAC_wild_hexp$Hexp)
QUAC_garden_wild_results[2,1] <- mean(QUAC_garden_allrich[,1]) ; QUAC_garden_wild_results[2,2] <- mean(QUAC_wild_allrich[,1])
QUAC_garden_wild_results
barplot(QUAC_garden_wild_results[1,1], QUAC_garden_wild_results[1,2])
barplot(QUAC_garden_wild_results[2,])
barplot(QUAC_garden_wild_results[2,1:2])
barplot(QUAC_garden_wild_results[2,1:2], labels = c("Garden", "Wild"))
barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"))
barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"))
barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"), ylab = "Allelic Richness", ylim = c(0, 12))
barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"),
ylab = "Allelic Richness", ylim = c(0, 12), col = c("darkseagreen1","darkgreen"))
?error.bar
error.bar <- function(x, y, upper, lower=upper, length=0.1,...){
arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
}
QUAC_garden_allrich[,1]
sd(QUAC_garden_allrich[,1])
sd(QUAC_garden_allrich[,1]), sd(QUAC_wild_allrich[,1])
sd(QUAC_wild_allrich[,1])
cbind(sd(QUAC_garden_allrich[,1]), sd(QUAC_wild_allrich[,1]))
?se
mean(QUAC_garden_allrich[,1]) + sd(QUAC_garden_allrich[,1])
mean(QUAC_garden_allrich[,1]) - sd(QUAC_garden_allrich[,1])
error.bar <- function(x, y, upper, lower=upper, length=0.1,...){
arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
}
the_barplot <- barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"),
ylab = "Allelic Richness", ylim = c(0, 12), col = c("darkseagreen1","darkgreen"))
error_bars <- cbind(sd(QUAC_garden_allrich[,1]), sd(QUAC_wild_allrich[,1]))
?arrows
garden_allrich_se <- sd(QUAC_garden_allrich[,1])/sqrt(length(QUAC_garden_allrich[,1]))
wild_allrich_se <- sd(QUAC_wild_allrich[,1])/sqrt(length(QUAC_wild_allrich[,1]))
garden_allrich_se
wild_allrich_se
mean(QUAC_garden_allrich[,1])
mean(QUAC_garden_allrich[,1]) - QUAC_garden_allrich[,1]
mean(QUAC_garden_allrich[,1]) - garden_allrich_se
arrows(c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se), (mean(QUAC_wild_allrich[,1]) - wild_allrich_se)),
c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se), (mean(QUAC_wild_allrich[,1]) + wild_allrich_se)))
arrows(x0 = 1, y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)), x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
arrows(x0 = "Garden", y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)), x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
QUAC_garden_wild_results
QUAC_garden_wild_results[2,1]
arrows(x0 = QUAC_garden_wild_results[2,1], y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)),
x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
arrows(x0 = x, y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)),
x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
arrows(x0 = QUAC_garden_allrich[,1], y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)),
x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
barplot(QUAC_garden_allrich[,1])
barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"),
ylab = "Allelic Richness", ylim = c(0, 12), col = c("darkseagreen1","darkgreen"))
the_barplot <- barplot(QUAC_garden_wild_results[2,1:2], names = c("Garden", "Wild"),
ylab = "Allelic Richness", ylim = c(0, 12), col = c("darkseagreen1","darkgreen"))
arrows(x0 = the_barplot, y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)),
x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
the_barplot[1]
the_barplot[1,]
the_barplot
arrows(x0 = the_barplot[1], y0 = c((mean(QUAC_garden_allrich[,1]) - garden_allrich_se)),
x1 = x0, y1 = c((mean(QUAC_garden_allrich[,1]) + garden_allrich_se)))
