QUAC_garden_wild <- read.genepop("C:/Users/eschumacher/Documents/GitHub/UAC_insitu_exsitu/QUAC_data_files/QUAC_adegenet_files/Garden_Wild/QUAC_garden_wild_clean.gen")
##
library(adegenet)
QUAC_garden_wild <- read.genepop("C:/Users/eschumacher/Documents/GitHub/UAC_insitu_exsitu/QUAC_data_files/QUAC_adegenet_files/Garden_Wild/QUAC_garden_wild_clean.gen")
QUAC_garden_wild <- read.genepop("C:/Users/eschumacher/Documents/GitHub/QUAC_insitu_exsitu/QUAC_data_files/QUAC_adegenet_files/Garden_Wild/QUAC_garden_wild_clean.gen", ncode = 3)
QUAC_EST_gen <- read.genepop("C:/Users/eschumacher/Documents/GitHub/QUAC_insitu_exsitu/QUAC_data_files/QUAC_adegenet_files/EST/QUAC_garden_cleaned_EST_onepop.gen", ncode = 3)
seppop(QUAC_garden_wild_gen)[[1]]
QUAC_garden_wild_gen <- read.genepop("C:/Users/eschumacher/Documents/GitHub/QUAC_insitu_exsitu/QUAC_data_files/QUAC_adegenet_files/Garden_Wild/QUAC_garden_wild_clean.gen", ncode = 3)
seppop(QUAC_garden_wild_gen)[[1]]
QUAC_EST_gen
?identical
rownames(QUAC_garden_wild_gen@tab)
tab(QUAC_EST_gen)
QUAC_EST_garden_df <- read.csv("C:\\Users\\eschumacher\\Documents\\GitHub\\QUAC_insitu_exsitu\\QUAC_data_files\\QUAC_data_frames\\EST\\QUAC_garden_clean_EST_df.csv")
QUAC_garden_df <- read.csv("C:\\Users\\eschumacher\\Documents\\GitHub\\QUAC_insitu_exsitu\\QUAC_data_files\\QUAC_data_frames\\Garden_Wild\\QUAC_garden_clean_df.csv")
names(QUAC_garden_df$ID)
QUAC_garden_df$ID
QUAC_EST_garden_df$Sample.ID
identical(QUAC_EST_garden_df$Sample.ID, QUAC_garden_df$ID)
######################################
### Loop for comparing diversity - wild/garden, EST vs. genomic
##############################
setwd("../QUAC_data_files")
######################################
### Loop for comparing diversity - wild/garden, EST vs. genomic
##############################
setwd("../../QUAC_data_files")
QUAC_Est_genepop_list <- list()
####load in data frames for EST/genomic microsat diversity comparison
QUAC_EST_genepop_list <- list()
####load in data frames for EST/genomic microsat diversity comparison
QUAC_EST_genepop_list <- list.files(path = "QUAC_adegenet_files/EST",
pattern = ".gen$")
####load in data frames for EST/genomic microsat diversity comparison
QUAC_EST_list <- list.files(path = "QUAC_adegenet_files/EST",
pattern = ".gen$")
QUAC_EST_genepop_list <- list()
QUAC_EST_genepop_list <- list()
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST",
QUAC_EST_list[[e]]), ncode = 3)
}
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
}
QUAC_EST_df_list <- list.files(path = "QUAC_data_frames/EST",
pattern = ".csv$")
####load in data frames for EST/genomic microsat diversity comparison
#load names of files
QUAC_EST_genepop_name_list <- list.files(path = "QUAC_adegenet_files/EST",
pattern = ".gen$")
QUAC_EST_df_name_list <- list.files(path = "QUAC_data_frames/EST",
pattern = ".csv$")
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
}
####load in data frames for EST/genomic microsat diversity comparison
#load names of files
QUAC_EST_genepop_name_list <- list.files(path = "QUAC_adegenet_files/EST",
pattern = ".gen$")
QUAC_EST_df_name_list <- list.files(path = "QUAC_data_frames/EST",
pattern = ".csv$")
##create lists to store data files for genepop and data frame files
QUAC_EST_genepop_list <- list()
QUAC_EST_df_list <- list()
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
}
View(QUAC_EST_df_list)
QUAC_EST_df_list[[1]]
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name populations and individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
levels(QUAC_EST_genepop_list[[e]]) <- unique(QUAC_EST_df_list[[e]][,2])
}
table(QUAC_EST_genepop_list[[3]]@pop)
QUAC_EST_df_list[[1]][,2]
table(QUAC_EST_genepop_list[[1]]@pop)
table(QUAC_EST_genepop_list[[2]]@pop)
QUAC_EST_genepop_list[[2]]
QUAC_EST_genepop_list[[3]]
QUAC_EST_genepop_list[[4]]
summary(QUAC_EST_genepop_list[[2]])
summary(QUAC_EST_genepop_list[[2]])[7]
as.numeric(summary(QUAC_EST_genepop_list[[2]])[7])
as.numeric(summary(QUAC_EST_genepop_list[[2]])[7]$Hexp)
unique(QUAC_EST_df_list[[1]][,2])
as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
as.numeric(summary(QUAC_EST_genepop_list[[1]])[7]$Hexp)
hexp_list <- list()
allrich_list <- list()
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
hexp_list[[e]] <- as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
allrich_list[[e]] <- allelic.richness(QUAC_EST_genepop_list[[e]])$Ar
}
library(hierstat)
library(hierfstat)
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
hexp_list[[e]] <- as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
allrich_list[[e]] <- allelic.richness(QUAC_EST_genepop_list[[e]])$Ar
}
allrich_list
hexp_list
boxplot(hexp_list[[1]], hexp_list[[2]], hexp_list[[3]], hexp_list[[4]])
boxplot(hexp_list[[1]], hexp_list[[2]], hexp_list[[3]], hexp_list[[4]], ylim = c(0,``))
boxplot(hexp_list[[1]], hexp_list[[2]], hexp_list[[3]], hexp_list[[4]], ylim = c(0,1))
aov(hexp_list[[1]], hexp_list[[2]], hexp_list[[3]], hexp_list[[4]])
?aov
as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
length(hexp_list[[1]])
QUAC_EST_df_name_list
##matrix name list
matrix_names <- c("QUAC_garden_clean_EST_df", "QUAC_garden_clean_non_EST_df",
"QUAC_wild_EST_df", "QUAC_wild_non_est_clean_df")
length(hexp_list[[1]])
length(hexp_list[[2]])
mapply(aov, hexp_list, SIMPLIFY = TRUE)
hexp_list[[2]]
anova(hexp_list[[2]], hexp_list[[1]])
15+15
##create matrix to store results
QUAC_EST_gendiv_comp <- matrix(nrow = 30, ncol = 2)
##create matrix to store results
QUAC_EST_gendiv_comp <- matrix(nrow = 30, ncol = 3)
##paste in individuals
QUAC_EST_gendiv_comp[1:10,1] <- "QUAC_garden_EST"
##paste in individuals
QUAC_EST_gendiv_comp[1:10,1] <- "QUAC_garden_EST"
QUAC_EST_gendiv_comp[11:15,1] <- "QUAC_garden_non_EST"
QUAC_EST_gendiv_comp[16:25,1] <- "QUAC_wild_EST"
QUAC_EST_gendiv_comp[26:30,1] <- "QUAC_wild_non_EST"
length(QUAC_EST_gendiv_comp)
length(QUAC_EST_gendiv_comp[1,])
QUAC_EST_gendiv_comp[1:10,2] <- hexp_list[[1]]
QUAC_EST_gendiv_comp
hexp_list[[1]]
hexp_list
length(hexp_list)
##now paste in values
QUAC_EST_gendiv_comp[1:10,2] <- as.numeric(allrich_list[[1]])
allrich_list[[1]]
allrich_list[[1]][,1]
##now paste in values
QUAC_EST_gendiv_comp[1:10,2] <- allrich_list[[1]][,1]
QUAC_EST_gendiv_comp
##now paste in values
QUAC_EST_gendiv_comp[1:10,2] <- as.numeric(allrich_list[[1]][,1])
QUAC_EST_gendiv_comp
##now paste in values
QUAC_EST_gendiv_comp[1:10,2] <- as.numeric(allrich_list[[1]][,1])
QUAC_EST_gendiv_comp[11:15,2] <- allrich_list[[2]][,1]
QUAC_EST_gendiv_comp[16:25,2] <- allrich_list[[3]][,1]
QUAC_EST_gendiv_comp[26:30,2] <- allrich_list[[4]][,1]
QUAC_EST_gendiv_comp
##paste in hexp values
QUAC_EST_gendiv_comp[1:10,3] <- hexp_list[[1]]
QUAC_EST_gendiv_comp[11:15,3] <- hexp_list[[2]]
QUAC_EST_gendiv_comp[16:25,3] <- hexp_list[[3]]
QUAC_EST_gendiv_comp[26:30,3] <- hexp_list[[4]]
?aov
aov(QUAC_EST_gendiv_comp[,2])
aov(as.numeric(QUAC_EST_gendiv_comp[,2])~QUAC_EST_gendiv_comp[,1])
summary(aov(as.numeric(QUAC_EST_gendiv_comp[,2])~QUAC_EST_gendiv_comp[,1]))
summary(kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~QUAC_EST_gendiv_comp[,1]))
summary(kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1])))
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[8]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[4]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[5]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[6]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[1]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[2]
kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[3]
QUAC_EST_hexp_pvalue <- kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,3])~as.factor(QUAC_EST_gendiv_comp[,1]))[3]
QUAC_EST_hexp_pvalue
##matrix name list
QUAC_EST_mean_df <- matrix(nrow = 5, ncol = 2)
allrich_list[,1]
allrich_list[[1]][,1]
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
hexp_list[[e]] <- as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
allrich_list[[e]] <- allelic.richness(QUAC_EST_genepop_list[[e]])$Ar
##generate means table
#add allrich calculations
QUAC_EST_mean_df[e,1] <- mean(allrich_list[[e]][,1])
#add hexp meeans
QUAC_EST_mean_df[e,2] <- mean(hexp_list[[e]])
}
QUAC_EST_mean_df
##add p-value to the mean table
QUAC_EST_mean_df[5,1] <- QUAC_EST_allrich_pvalue
QUAC_EST_mean_df[5,2] <- QUAC_EST_hexp_pvalue
##save p-value
QUAC_EST_allrich_pvalue <- kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,2])~as.factor(QUAC_EST_gendiv_comp[,1]))[3]
QUAC_EST_hexp_pvalue <- kruskal.test(as.numeric(QUAC_EST_gendiv_comp[,3])~as.factor(QUAC_EST_gendiv_comp[,1]))[3]
##add p-value to the mean table
QUAC_EST_mean_df[5,1] <- QUAC_EST_allrich_pvalue
QUAC_EST_mean_df[5,2] <- QUAC_EST_hexp_pvalue
QUAC_EST_allrich_pvalue
QUAC_EST_allrich_pvalue$p.value
##add p-value to the mean table
QUAC_EST_mean_df[5,1] <- QUAC_EST_allrich_pvalue$p.value
unlist(QUAC_EST_allrich_pvalue$p.value)
unlist(QUAC_EST_allrich_pvalue)
unlist(QUAC_EST_allrich_pvalue$p.value)
##add p-value to the mean table
QUAC_EST_mean_df[5,1] <- unlist(QUAC_EST_allrich_pvalue$p.value)
QUAC_EST_mean_df
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
hexp_list[[e]] <- as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
allrich_list[[e]] <- allelic.richness(QUAC_EST_genepop_list[[e]])$Ar
##generate means table
#add allrich calculations
QUAC_EST_mean_df[e,1] <- mean(allrich_list[[e]][,1])
#add hexp meeans
QUAC_EST_mean_df[e,2] <- mean(hexp_list[[e]])
}
##matrix name list
QUAC_EST_mean_df <- matrix(nrow = 5, ncol = 2)
##loop to write in files
for(e in 1:length(QUAC_EST_list)){
QUAC_EST_genepop_list[[e]] <- read.genepop(paste0("QUAC_adegenet_files/EST/",
QUAC_EST_list[[e]]), ncode = 3)
##load data frames
QUAC_EST_df_list[[e]] <- read.csv(paste0("QUAC_data_frames/EST/", QUAC_EST_df_name_list[[e]] ))
##name individuals within each genind object
rownames(QUAC_EST_genepop_list[[e]]@tab) <- QUAC_EST_df_list[[e]][,1]
hexp_list[[e]] <- as.numeric(summary(QUAC_EST_genepop_list[[e]])[7]$Hexp)
allrich_list[[e]] <- allelic.richness(QUAC_EST_genepop_list[[e]])$Ar
##generate means table
#add allrich calculations
QUAC_EST_mean_df[e,1] <- mean(allrich_list[[e]][,1])
#add hexp meeans
QUAC_EST_mean_df[e,2] <- mean(hexp_list[[e]])
}
QUAC_EST_mean_df
##add p-value to the mean table
QUAC_EST_mean_df[5,1] <- unlist(QUAC_EST_allrich_pvalue$p.value)
QUAC_EST_mean_df
QUAC_EST_mean_df[5,2] <- unlist(QUAC_EST_hexp_pvalue$p.value)
QUAC_EST_df_name_list
sub("\\.$"",QUAC_EST_df_name_list)
)
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
QUAC_EST_df_name_list
gsub("\\.$"",QUAC_EST_df_name_list)
""
gsub("\\.$",QUAC_EST_df_name_list)
gsub(".*\\.$",QUAC_EST_df_name_list)
sub(".*\\.$",QUAC_EST_df_name_list)
sub(".*\\.$","",QUAC_EST_df_name_list)
sub("^.*\\.","",QUAC_EST_df_name_list)
sub("^.*.\\","",QUAC_EST_df_name_list)
sub("^..*\\","",QUAC_EST_df_name_list)
sub("\\..*","",QUAC_EST_df_name_list)
source('~/.active-rstudio-document', echo=TRUE)
##now add information and write out matrix
rownames(QUAC_EST_mean_df) <- c(sub("\\..*","",QUAC_EST_df_name_list), "p-value")
QUAC_EST_mean_df
colnames(QUAC_EST_mean_df) <- c("Allelic Richness", "Expected Heterozygosity")
##now add information and write out matrix
rownames(QUAC_EST_mean_df) <- c(sub("\\..*","",QUAC_EST_df_name_list), "p-value")
colnames(QUAC_EST_mean_df) <- c("Allelic Richness", "Expected Heterozygosity")
##round
QUAC_EST_mean_df <- signif(QUAC_EST_mean_df, 3)
##write out matrix
write.csv(QUAC_EST_mean_df, "../QUAC_analyses/Results/Wild_Garden_Comparison/QUAC_EST_mean_df.csv")
boxplot(QUAC_EST_gendiv_comp[,2])
boxplot(QUAC_EST_gendiv_comp[,1], QUAC_EST_gendiv_comp[,2])
boxplot(QUAC_EST_gendiv_comp[,1], as.numeric( QUAC_EST_gendiv_comp[,2]))
boxplot(as.numeric( QUAC_EST_gendiv_comp[,2])
)
boxplot(hexp_list)
#####visualize results
##plot boxplots
boxplot(hexp_list, names = sub("\\..*","",QUAC_EST_df_name_list))
boxplot(allrich_list[[1]][,1], allrich_list[[2]][,1], allrich_list[[3]][,1], allrich_list[[4]][,1])
sub("\\..*","",QUAC_EST_df_name_list)
#####visualize results
##plot boxplots
boxplot(hexp_list, names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"))
#####visualize results
##plot boxplots
boxplot(hexp_list, names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"),
ylim = c(0,1))
boxplot(allrich_list[[1]][,1], allrich_list[[2]][,1], allrich_list[[3]][,1], allrich_list[[4]][,1])
boxplot(allrich_list[[1]][,1], allrich_list[[2]][,1], allrich_list[[3]][,1], allrich_list[[4]][,1],
ylim = c(0,25), names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"))
#####visualize results
##plot boxplots
pdf("../QUAC_analyses/Results/Wild_Garden_Comparison/QUAC_EST_boxplots.pdf")
boxplot(hexp_list, names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"),
ylim = c(0,1))
boxplot(allrich_list[[1]][,1], allrich_list[[2]][,1], allrich_list[[3]][,1], allrich_list[[4]][,1],
ylim = c(0,25), names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"))
dev.off()
#####visualize results
##plot boxplots
pdf("../QUAC_analyses/Results/Wild_Garden_Comparison/QUAC_EST_boxplots.pdf")
boxplot(hexp_list, names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"),
ylim = c(0,1), main = "Expected Heterozygosity Compared Over Garden, Wild, ESTs, and Genomic Microsatellite Regions")
boxplot(allrich_list[[1]][,1], allrich_list[[2]][,1], allrich_list[[3]][,1], allrich_list[[4]][,1],
ylim = c(0,25), names = c("Garden EST","Garden Genomic", "Wild EST", "Wild Genomic"),
main = "Allelic Richness Compared Over Garden, Wild, ESTs, and Genomic Microsatellite Regions")
dev.off()
