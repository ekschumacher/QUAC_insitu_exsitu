library(adegenet)
library(poppr)
library(hierfstat)
library(PopGenReport)
library(pegas)
#######################################
########## Load genind files ##########
#######################################
##set working directory to load in data files
setwd("../../QUAC_data_files")
##load in QUAC genepop file as a genind object, with all populations and missing data removed
QUAC_allpop_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_allpop_clean.gen", ncode = 3)
table(QUAC_allpop_gen@pop)
##load in genepop files as genind objects for garden and wild individuals separately
##without missing data or clones
QUAC_garden_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_garden_clean.gen", ncode = 3)
QUAC_allpop_gen
##load in QUAC genepop file as a genind object, with all populations and missing data removed
QUAC_allpop_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_allpop_clean.gen", ncode = 3)
QUAC_allpop_gen
##load in QUAC genepop file as a genind object, with all populations and missing data removed
QUAC_allpop_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_allpop_clean.gen", ncode = 3)
QUAC_allpop_gen
QUAC_allpop_gen
##load in genepop files as genind objects for garden and wild individuals separately
##without missing data or clones
QUAC_garden_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_garden_clean.gen", ncode = 3)
QUAC_wild_gen <- read.genepop("QUAC_adegenet_files/Garden_Wild/QUAC_wild_clean.gen", ncode = 3)
##load in data frame
QUAC_allpop_df <- read.csv("QUAC_data_frames/QUAC_allpop_clean.csv")
##rename individuals in the genind file
rownames(QUAC_allpop_gen@tab) <- QUAC_allpop_df$ID
QUAC_allpop_df$Ind
##rename individuals in the genind file
rownames(QUAC_allpop_gen@tab) <- QUAC_allpop_df$Ind
##create population name lists
QUAC_popnames <- unique(QUAC_allpop_df$Pop)
##rename pops in genind
levels(QUAC_allpop_gen@pop) <- QUAC_popnames
###########################################
########## Genetic Stats by Pop ###########
###########################################
##Garden vs. wild diversity capture
QUAC_pop_type_gen <- c("QUAC_garden_clean.gen", "QUAC_wild_clean.gen")
QUAC_pop_type_df <- c("QUAC_garden_clean_df.csv", "QUAC_wild_clean_df.csv")
##first read in data frames in
for(a in 1:length(QUAC_pop_type_df)) {
QUAC_pop_df_list[[a]] <- read.csv(paste0("QUAC_data_frames/Garden_Wild/", QUAC_pop_type_df[[a]]))
}
##create data frame list
QUAC_pop_df_list <- list()
##first read in data frames in
for(a in 1:length(QUAC_pop_type_df)) {
QUAC_pop_df_list[[a]] <- read.csv(paste0("QUAC_data_frames/Garden_Wild/", QUAC_pop_type_df[[a]]))
}
QUAC_pop_df_list[[1]]
##create a list to save all the data frames
QUAC_allpop_gendiv_sumstat_list <- list()
QUAC_pop_type_gen[[1]]
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_analysis_results, "/Sum_Stats/", QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
##create lists for genetic diversity statistics
QUAC_allrich_list <- list()
QUAC_hexp_list <- list()
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_analysis_results, "/Sum_Stats/", QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
setwd("../Results/Sum_Stats")
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
setwd("../QUAC_analyses/Results/Sum_Stats")
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
QUAC_pop_type
###########################################
########## Genetic Stats by Pop ###########
###########################################
##Garden vs. wild diversity capture
QUAC_pop_type_gen <- c("QUAC_garden_clean.gen", "QUAC_wild_clean.gen")
QUAC_pop_type_df <- c("QUAC_garden_clean_df.csv", "QUAC_wild_clean_df.csv")
#create list of 'pop type' for naming output files
QUAC_pop_type <- c("garden","wild")
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
setwd("../QUAC_analyses/Results/Sum_Stats")
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##first set the working directory for the analyses
setwd("../../../QUAC_data_files")
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
setwd("../QUAC_analyses/Results/Sum_Stats")
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
###########################################
########## Genetic Stats by Pop ###########
###########################################
##Garden vs. wild diversity capture
#create lists for loop of the object and files used in analyses
QUAC_pop_type_gen <- c("QUAC_garden_clean.gen", "QUAC_wild_clean.gen")
QUAC_pop_type_df <- c("QUAC_garden_clean_df.csv", "QUAC_wild_clean_df.csv")
#create list of 'pop type' for naming output files
QUAC_pop_type <- c("QUAC_garden","QUAC_wild")
##create data frame list
QUAC_pop_df_list <- list()
##first read in data frames in
for(a in 1:length(QUAC_pop_type_df)) {
QUAC_pop_df_list[[a]] <- read.csv(paste0("QUAC_data_frames/Garden_Wild/", QUAC_pop_type_df[[a]]))
}
##create a list to save all the data frames
QUAC_allpop_gendiv_sumstat_list <- list()
##create lists for genetic diversity statistics
QUAC_allrich_list <- list()
QUAC_hexp_list <- list()
#######################################
########## Load genind files ##########
#######################################
##set working directory to load in data files
setwd("../../QUAC_data_files")
setwd("../../../QUAC_data_files")
###########################################
########## Genetic Stats by Pop ###########
###########################################
##Garden vs. wild diversity capture
#create lists for loop of the object and files used in analyses
QUAC_pop_type_gen <- c("QUAC_garden_clean.gen", "QUAC_wild_clean.gen")
QUAC_pop_type_df <- c("QUAC_garden_clean_df.csv", "QUAC_wild_clean_df.csv")
#create list of 'pop type' for naming output files
QUAC_pop_type <- c("QUAC_garden","QUAC_wild")
##create data frame list
QUAC_pop_df_list <- list()
##first read in data frames in
for(a in 1:length(QUAC_pop_type_df)) {
QUAC_pop_df_list[[a]] <- read.csv(paste0("QUAC_data_frames/Garden_Wild/", QUAC_pop_type_df[[a]]))
}
##create a list to save all the data frames
QUAC_allpop_gendiv_sumstat_list <- list()
##create lists for genetic diversity statistics
QUAC_allrich_list <- list()
QUAC_hexp_list <- list()
##write loop to calculate all summary stats
for(pop in 1:length(QUAC_pop_type_gen)){
##first set the working directory for the analyses
setwd("../../../QUAC_data_files")
##load in genepop file as a genind object
QUAC_temp_gen <- read.genepop(paste0("QUAC_adegenet_files/Garden_Wild/", QUAC_pop_type_gen[[pop]]), ncode = 3)
##rename rownames
rownames(QUAC_temp_gen@tab) <- QUAC_pop_df_list[[pop]][,1]
##get pop names
QUAC_pop_names <- unique(QUAC_pop_df_list[[pop]][,2])
##rename pops
levels(QUAC_temp_gen@pop) <- QUAC_pop_names
###start genetic analyses
QUAC_temp_sum <- summary(QUAC_temp_gen)
##create poppr file
QUAC_poppr <- poppr(QUAC_temp_gen)
##save mean for final output table
QUAC_hexp_mean <- QUAC_poppr[1:length(table(QUAC_temp_gen@pop)),10]
##allele numbers by pop
QUAC_nall <- QUAC_temp_sum$pop.n.all
##individual numbers
QUAC_ind <- QUAC_poppr[1:length(QUAC_pop_names), 2:3]
##save allelic richness for comparison
QUAC_allrich_list[[pop]] <- allelic.richness(QUAC_temp_gen)$Ar
QUAC_allrich_mean <- colMeans(allelic.richness(QUAC_temp_gen)$Ar)
##create data frame
QUAC_allpop_gendiv_sumstat_df <- signif(cbind(QUAC_ind, QUAC_nall, QUAC_allrich_mean, QUAC_hexp_mean),3)
##name columns and rows
rownames(QUAC_allpop_gendiv_sumstat_df) <- QUAC_pop_names
colnames(QUAC_allpop_gendiv_sumstat_df) <- c("Ind", "MLG", "Number of Alleles", "Allelic Richness", "Expected Heterozygosity")
if(pop == 2){
##Calculate mean longitude and latitude for each wild population
#first create matrices
QUAC_mean_lon <- matrix()
QUAC_mean_lat <- matrix()
##identifying mean latitudes for each population
for(pop2 in QUAC_pop_names){
QUAC_mean_lon[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,3])
QUAC_mean_lon <- matrix(QUAC_mean_lon)
}
for(pop2 in QUAC_pop_names){
QUAC_mean_lat[pop2] <- mean(QUAC_pop_df_list[[pop]][QUAC_pop_df_list[[pop]]$Pop == pop2,][,4])
QUAC_mean_lat <- matrix(QUAC_mean_lat)
}
QUAC_lonlat_df <- cbind(QUAC_mean_lon, QUAC_mean_lat)
QUAC_lonlat_df <- QUAC_lonlat_df[c(2:6),]
QUAC_allpop_gendiv_sumstat_df <- cbind(QUAC_lonlat_df, QUAC_allpop_gendiv_sumstat_df)
}
##write out csv
setwd("../QUAC_analyses/Results/Sum_Stats")
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0(QUAC_pop_type[[pop]],"_gendiv_sumstat_df.csv"))
}
#######################################
############ Directories ##############
#######################################
QUAC_analyses_results <- "QUAC_analyses/Results/Sum_Stats"
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses_results/", QUAC_pop_type[[2]], "_gendiv_sumstat_df.csv"))
write.csv(QUAC_allpop_gendiv_sumstat_df, paste0("../QUAC_analyses/Results/Sum_Stats/", QUAC_pop_type[[2]], "_gendiv_sumstat_df.csv"))
library(adegenet)
